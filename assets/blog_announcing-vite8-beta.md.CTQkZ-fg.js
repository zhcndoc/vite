import{_ as e,o as t,i as a,R as s,aR as n}from"./chunks/framework.Caqowgrb.js";const k=JSON.parse('{"title":"Vite 8 Beta: The Rolldown-powered Vite","description":"","frontmatter":{"title":"Vite 8 Beta: The Rolldown-powered Vite","author":{"name":"The Vite Team"},"date":"2025-12-03T00:00:00.000Z","sidebar":false,"head":[["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:title","content":"Announcing Vite 8 Beta"}],["meta",{"property":"og:image","content":"https://vite.dev/og-image-announcing-vite8-beta.webp"}],["meta",{"property":"og:url","content":"https://vite.dev/blog/announcing-vite8-beta"}],["meta",{"property":"og:description","content":"Vite 8 Beta Release Announcement"}],["meta",{"name":"twitter:card","content":"summary_large_image"}]]},"headers":[],"relativePath":"blog/announcing-vite8-beta.md","filePath":"blog/announcing-vite8-beta.md"}'),l={name:"blog/announcing-vite8-beta.md"};function o(r,i,p,h,d,g){return t(),a("div",null,[...i[0]||(i[0]=[s('<h1 id="vite-8-beta" tabindex="-1">Vite 8 Beta：由 Rolldown 驱动的 Vite <a class="header-anchor" href="#vite-8-beta" aria-label="Permalink to “Vite 8 Beta：由 Rolldown 驱动的 Vite”">​</a></h1><p><em>2025年12月3日</em></p><p><img src="'+n+`" alt="Vite 8 Beta Announcement Cover Image" width="2400" height="1206"></p><p>摘要：由 <a href="https://rolldown.rs/" target="_blank" rel="noreferrer">Rolldown</a> 驱动的 Vite 8 首个 beta 版本现已发布。Vite 8 显著提升了生产环境构建速度，并为未来的改进奠定了基础。你可以将 <code>vite</code> 升级到 <code>8.0.0-beta.0</code> 版本并阅读<a href="/guide/migration">迁移指南</a>来体验新版本。</p><hr><p>我们很高兴发布 Vite 8 的首个 beta 版本。此版本统一了底层工具链，带来了更一致性的行为，并显著提升了构建性能。Vite 现在使用 <a href="https://rolldown.rs/" target="_blank" rel="noreferrer">Rolldown</a> 作为其打包工具，取代了之前 esbuild 和 Rollup 的组合。</p><h2 id="a-new-bundler-for-the-web" tabindex="-1">一款全新的 Web 打包工具 <a class="header-anchor" href="#a-new-bundler-for-the-web" aria-label="Permalink to “一款全新的 Web 打包工具”">​</a></h2><p>Vite 之前依赖两个打包工具来满足开发和生产构建的不同需求：</p><ol><li>开发期间使用 esbuild 进行快速编译</li><li>生产构建使用 Rollup 进行打包、分块和优化</li></ol><p>这种方法让 Vite 能够专注于开发者体验和协调，而无需重新发明解析和打包功能。然而，维护两个独立的打包流水线引入了不一致性：独立的转换流水线、不同的插件系统，以及为了保持开发和生产环境打包行为的一致性而编写的大量粘合代码。</p><p>为了解决这个问题，<a href="https://voidzero.dev" target="_blank" rel="noreferrer">VoidZero 团队</a> 开发了 <strong>Rolldown</strong>，这是一款面向 Vite 的新一代打包工具。它的设计特点包括：</p><ul><li><strong>性能</strong>：Rolldown 使用 Rust 编写，运行速度与原生应用相当。它的性能水平与 esbuild 相匹配，并且比 Rollup <a href="https://github.com/rolldown/benchmarks" target="_blank" rel="noreferrer">快 10-30 倍</a>。</li><li><strong>兼容性</strong>：Rolldown 支持与 Rollup 和 Vite 相同的插件 API。大多数 Vite 插件在 Vite 8 中可以开箱即用。</li><li><strong>更多功能</strong>：Rolldown 为 Vite 解锁了更多高级功能，包括完整打包模式、更灵活的分块控制、模块级持久缓存、模块联邦等。</li></ul><h2 id="unifying-the-toolchain" tabindex="-1">统一工具链 <a class="header-anchor" href="#unifying-the-toolchain" aria-label="Permalink to “统一工具链”">​</a></h2><p>Vite 的打包工具替换带来的影响远不止性能提升。打包工具利用语法解析器（parsers）、依赖解析器（resolvers）、转换器（transformers）和压缩器（minifiers）。Rolldown 为此目的使用了由 VoidZero 团队主导的另一个项目 Oxc。</p><p><strong>这使得 Vite 成为由同一团队维护的端到端工具链的入口：构建工具（Vite）、打包工具（Rolldown）和编译器（Oxc）。</strong></p><p>这种一致性确保了整个技术栈的行为一致性，并使我们能够随着 JavaScript 的不断发展快速采用并适应新的语言规范。它还带来了一系列以前仅靠 Vite 无法实现的改进。例如，我们可以利用 Oxc 的语义分析来改进 Rolldown 中的 tree-shaking 操作。</p><h2 id="how-vite-migrated-to-rolldown" tabindex="-1">Vite 如何迁移到 Rolldown <a class="header-anchor" href="#how-vite-migrated-to-rolldown" aria-label="Permalink to “Vite 如何迁移到 Rolldown”">​</a></h2><p>迁移到由 Rolldown 驱动的 Vite 是一项根本性的变革。因此，我们的团队采取了周密的措施来实现这一目标，同时确保稳定性和生态系统兼容性。</p><p>首先，我们发布了独立的 <code>rolldown-vite</code> 包作为<a href="https://voidzero.dev/posts/announcing-rolldown-vite" target="_blank" rel="noreferrer">技术预览版</a>。这让我们能够在不影响 Vite 稳定版本的情况下与早期用户进行合作。早期用户不仅受益于 Rolldown 带来的性能提升，还提供了宝贵的反馈意见。亮点包括：</p><ul><li>Linear 的生产构建时间从 46 秒减少到 6 秒</li><li>Ramp 将它们的建造时间缩短了 57%</li><li>Mercedes-Benz.io 将构建时间减少了高达 38%</li><li>Beehiiv 将构建时间减少了 64%</li></ul><p>接下来，我们搭建了一套测试套件，用于验证关键的 Vite 插件与 <code>rolldown-vite</code> 的兼容性。这项 CI 任务帮助我们及早发现回归问题和兼容性问题，特别是对于 SvelteKit、react-router 和 Storybook 等框架和元框架。</p><p>最后，我们构建了一个兼容层，以帮助开发者从 Rollup 和 esbuild 选项迁移到相应的 Rolldown 选项。</p><p>因此，每个人都能顺利迁移到 Vite 8。</p><h2 id="migrating-to-vite-8-beta" tabindex="-1">迁移到 Vite 8 Beta <a class="header-anchor" href="#migrating-to-vite-8-beta" aria-label="Permalink to “迁移到 Vite 8 Beta”">​</a></h2><p>由于 Vite 8 涉及核心构建行为，我们着重保持配置 API 和插件钩子不变。我们创建了<a href="/guide/migration">迁移指南</a>来帮助你进行升级。</p><p>有两种可用的升级路径：</p><ol><li><strong>直接升级</strong>：更新 <code>package.json</code> 并运行常规的开发和构建命令。</li><li><strong>渐进式迁移</strong>：先从 Vite 7 迁移到 <code>rolldown-vite</code> 包，然后再到 Vite 8。这样你可以识别出与 Rolldown 相关的不兼容性或问题，而无需对 Vite 进行其他更改。（推荐用于较大或复杂的项目）</li></ol><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>如果你依赖特定的 Rollup 或 esbuild 选项，你可能需要对 Vite 配置进行一些调整。请参考<a href="/guide/migration">迁移指南</a>获取详细的说明和示例。 与所有非稳定的主版本一样，升级后建议进行全面测试以确保一切运行正常。如有任何<a href="https://github.com/vitejs/rolldown-vite/issues" target="_blank" rel="noreferrer">问题</a>，请务必报告。</p></div><p>如果你使用的框架或工具依赖于 Vite，例如 Astro、Nuxt 或 Vitest，你必须在 <code>package.json</code> 中覆盖 <code>vite</code> 依赖项，具体操作方式因包管理器而异：</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-138" id="tab-139" checked><label data-title="npm" for="tab-139">npm</label><input type="radio" name="group-138" id="tab-140"><label data-title="Yarn" for="tab-140">Yarn</label><input type="radio" name="group-138" id="tab-141"><label data-title="pnpm" for="tab-141">pnpm</label><input type="radio" name="group-138" id="tab-142"><label data-title="Bun" for="tab-142">Bun</label></div><div class="blocks"><div class="language-json active"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;overrides&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;vite&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8.0.0-beta.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resolutions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;vite&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8.0.0-beta.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pnpm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;overrides&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;vite&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8.0.0-beta.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;overrides&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;vite&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8.0.0-beta.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></div></div><p>添加这些覆盖设置后，重新安装依赖项，然后像往常一样启动开发服务器或构建你的项目。</p><h2 id="additional-features-in-vite-8" tabindex="-1">Vite 8 的附加功能 <a class="header-anchor" href="#additional-features-in-vite-8" aria-label="Permalink to “Vite 8 的附加功能”">​</a></h2><p>除了搭载 Rolldown 之外，Vite 8 还带来了以下功能：</p><ul><li><strong>内置 tsconfig <code>paths</code> 支持</strong>：开发者可以通过将 <a href="/config/shared-options#resolve-tsconfigpaths"><code>resolve.tsconfigPaths</code></a> 设置为 <code>true</code> 来启用此功能。此功能会略微影响性能，因此默认情况下未启用。</li><li><strong><code>emitDecoratorMetadata</code> 支持</strong>：Vite 8 现在内置了对 TypeScript <a href="https://www.typescriptlang.org/tsconfig/#emitDecoratorMetadata" target="_blank" rel="noreferrer"><code>emitDecoratorMetadata</code> 选项</a>的自动支持。更多详情请参见<a href="/guide/features#emitdecoratormetadata">功能</a>页面。</li></ul><h2 id="looking-ahead" tabindex="-1">展望未来 <a class="header-anchor" href="#looking-ahead" aria-label="Permalink to “展望未来”">​</a></h2><p>速度一直是 Vite 的一大特色。与 Rolldown 以及 Oxc 的集成意味着 JavaScript 开发者可以充分利用 Rust 的速度优势。升级到 Vite 8 后，仅使用 Rust 本身就能带来性能提升。</p><p>我们也即将推出 Vite 的完整打包模式，该模式将大幅提升 Vite 开发服务器在大型项目中的速度。初步测试结果显示，开发服务器启动速度提升 3 倍，完全重新加载速度提升 40%，网络请求次数减少 10 倍。</p><p>Vite 的另一大特色是其插件生态系统。我们希望 JavaScript 开发者能够继续使用他们熟悉的 JavaScript 语言来扩展和定制 Vite，同时又能受益于 Rust 的性能优势。我们的团队正在与 VoidZero 团队合作，以加速这些基于 Rust 系统中 JavaScript 插件的使用。</p><p>即将推出的优化功能目前处于实验阶段：</p><ul><li><a href="https://github.com/oxc-project/oxc/issues/2409" target="_blank" rel="noreferrer"><strong>原始 AST 传输</strong></a>。允许 JavaScript 插件以最小的开销访问 Rust 生成的 AST。</li><li><a href="https://rolldown.rs/in-depth/native-magic-string#native-magicstring" target="_blank" rel="noreferrer"><strong>原生 MagicString 转换</strong></a>。简单的自定义转换，逻辑用 JavaScript 编写，但计算用 Rust 完成。</li></ul><h2 id="connect-with-us" tabindex="-1"><strong>联系我们</strong> <a class="header-anchor" href="#connect-with-us" aria-label="Permalink to “联系我们”">​</a></h2><p>如果你已经尝试过 Vite 8 测试版，我们非常希望听到你的反馈！请报告任何问题或分享你的使用体验：</p><ul><li><strong>Discord</strong>：加入我们的<a href="https://chat.vite.dev/" target="_blank" rel="noreferrer">社区服务器</a>进行实时讨论</li><li><strong>GitHub</strong>：在 <a href="https://github.com/vitejs/vite/discussions" target="_blank" rel="noreferrer">GitHub 讨论区</a>分享反馈</li><li><strong>问题报告</strong>：在 <a href="https://github.com/vitejs/rolldown-vite/issues" target="_blank" rel="noreferrer">rolldown-vite 仓库</a>报告 bug 和回归问题</li><li><strong>成果分享</strong>：在 <a href="https://github.com/vitejs/rolldown-vite-perf-wins" target="_blank" rel="noreferrer">rolldown-vite-perf-wins 仓库</a>分享你改善的构建时间</li></ul><p>我们感谢所有提交的报告和复现案例。它们有助于我们发布稳定的 8.0.0 版本。</p>`,44)])])}const u=e(l,[["render",o]]);export{k as __pageData,u as default};
