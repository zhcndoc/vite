import{_ as r,c as o,o as a,aq as i}from"./chunks/framework.CYFbgU53.js";const u=JSON.parse('{"title":"从 v6 迁移","description":"","frontmatter":{"head":[["link",{"rel":"canonical","href":"https://vite.zhcndoc.com/guide/migration"}],["meta",{"property":"og:title","content":"从 v6 迁移"}]]},"headers":[],"relativePath":"guide/migration.md","filePath":"guide/migration.md"}'),l={name:"guide/migration.md"};function t(d,e,s,c,n,p){return a(),o("div",null,[...e[0]||(e[0]=[i('<h1 id="migration-from-v6" tabindex="-1">从 v6 迁移 <a class="header-anchor" href="#migration-from-v6" aria-label="Permalink to “从 v6 迁移”">​</a></h1><h2 id="node-js-support" tabindex="-1">Node.js 支持 <a class="header-anchor" href="#node-js-support" aria-label="Permalink to “Node.js 支持”">​</a></h2><p>Vite 不再支持已结束生命周期（EOL）的 Node.js 18。现在需要使用 Node.js 20.19+ 或 22.12+。</p><h2 id="default-browser-target-change" tabindex="-1">浏览器兼容性目标变更 <a class="header-anchor" href="#default-browser-target-change" aria-label="Permalink to “浏览器兼容性目标变更”">​</a></h2><p><code>build.target</code> 的默认浏览器值已更新为较新的浏览器版本。</p><ul><li>Chrome 87 → 107</li><li>Edge 88 → 107</li><li>Firefox 78 → 104</li><li>Safari 14.0 → 16.0</li></ul><p>这些浏览器版本符合 <a href="https://web-platform-dx.github.io/web-features/" target="_blank" rel="noreferrer">Baseline</a> 在 2025-05-01 时定义的“广泛可用”功能集标准。换句话说，它们的发布日期都在 2022-11-01 之前。</p><p>在 Vite 5 中，默认目标名为 <code>&#39;modules&#39;</code>，但现在该选项已不再可用。取而代之的是引入了一个新的默认目标 <code>&#39;baseline-widely-available&#39;</code>。</p><h2 id="general-changes" tabindex="-1">总体变化 <a class="header-anchor" href="#general-changes" aria-label="Permalink to “总体变化”">​</a></h2><h3 id="removed-sass-old-api-support" tabindex="-1">移除了 Sass 旧版 API 支持 <a class="header-anchor" href="#removed-sass-old-api-support" aria-label="Permalink to “移除了 Sass 旧版 API 支持”">​</a></h3><p>如计划所述，Sass 旧版 API 的支持已被移除。Vite 现在仅支持现代 API。你可以移除 <code>css.preprocessorOptions.sass.api</code> 和 <code>css.preprocessorOptions.scss.api</code> 配置选项。</p><h2 id="removed-deprecated-features" tabindex="-1">移除了已弃用的功能 <a class="header-anchor" href="#removed-deprecated-features" aria-label="Permalink to “移除了已弃用的功能”">​</a></h2><ul><li><code>splitVendorChunkPlugin</code>（在 v5.2.7 中弃用） <ul><li>该插件最初是为了方便迁移到 Vite v2.9 而提供的。</li><li>如有需要，可以使用 <code>build.rollupOptions.output.manualChunks</code> 选项来控制分块行为。</li></ul></li><li><code>transformIndexHtml</code> 的 hook 级别 <code>enforce</code> / <code>transform</code>（在 v4.0.0 中弃用） <ul><li>此更改是为了与 <a href="https://rollupjs.org/plugin-development/#build-hooks:~:text=Instead%20of%20a%20function%2C%20hooks%20can%20also%20be%20objects." target="_blank" rel="noreferrer">Rollup 的对象型 hooks</a> 接口保持一致。</li><li>应使用 <code>order</code> 替代 <code>enforce</code>，使用 <code>handler</code> 替代 <code>transform</code>。</li></ul></li></ul><h2 id="advanced" tabindex="-1">进阶 <a class="header-anchor" href="#advanced" aria-label="Permalink to “进阶”">​</a></h2><p>还有其他一些只影响少数用户的破坏性更改。</p><ul><li><a href="https://github.com/vitejs/vite/pull/19979" target="_blank" rel="noreferrer">[#19979] chore: declare version range for peer dependencies</a><ul><li>为 CSS 预处理器指定了 peerDependencies 的版本范围。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/20013" target="_blank" rel="noreferrer">[#20013] refactor: remove no-op <code>legacy.proxySsrExternalModules</code></a><ul><li><code>legacy.proxySsrExternalModules</code> 属性自 Vite 6 起已无实际作用，现已移除。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/19985" target="_blank" rel="noreferrer">[#19985] refactor!: remove deprecated no-op type only properties</a><ul><li>以下未使用的属性现已移除：<code>ModuleRunnerOptions.root</code>、<code>ViteDevServer._importGlobMap</code>、<code>ResolvePluginOptions.isFromTsImporter</code>、<code>ResolvePluginOptions.getDepsOptimizer</code>、<code>ResolvePluginOptions.shouldExternalize</code>、<code>ResolvePluginOptions.ssrConfig</code></li></ul></li><li><a href="https://github.com/vitejs/vite/pull/19986" target="_blank" rel="noreferrer">[#19986] refactor: remove deprecated env api properties</a><ul><li>这些属性从一开始就被标记为弃用，现已移除。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/19987" target="_blank" rel="noreferrer">[#19987] refactor!: remove deprecated <code>HotBroadcaster</code> related types</a><ul><li>这些类型是作为现已弃用的 Runtime API 的一部分引入的，现已被移除：<code>HMRBroadcaster</code>、<code>HMRBroadcasterClient</code>、<code>ServerHMRChannel</code>、<code>HMRChannel</code>。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/19996" target="_blank" rel="noreferrer">[#19996] fix(ssr)!: don&#39;t access <code>Object</code> variable in ssr transformed code</a><ul><li><code>__vite_ssr_exportName__</code> 现在是模块运行时上下文中的必需字段。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/20045" target="_blank" rel="noreferrer">[#20045] fix: treat all <code>optimizeDeps.entries</code> values as globs</a><ul><li><code>optimizeDeps.entries</code> 不再接收字面量字符串路径，而是始终接收 glob 模式。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/20222" target="_blank" rel="noreferrer">[#20222] feat: apply some middlewares before <code>configureServer</code> hook</a>, <a href="https://github.com/vitejs/vite/pull/20224" target="_blank" rel="noreferrer">[#20224] feat: apply some middlewares before <code>configurePreviewServer</code> hook</a><ul><li>某些中间件现在会在 <code>configureServer</code> / <code>configurePreviewServer</code> 钩子之前被应用。请注意，如果你不希望某个路由应用 <a href="./../config/server-options.html#server-cors"><code>server.cors</code></a> / <a href="./../config/preview-options.html#preview-cors"><code>preview.cors</code></a> 配置，请务必从响应中移除相关的请求头。</li></ul></li></ul><h2 id="migration-from-v5" tabindex="-1">从 v5 迁移 <a class="header-anchor" href="#migration-from-v5" aria-label="Permalink to “从 v5 迁移”">​</a></h2><p>请先查阅 Vite v6 文档中的 <a href="https://v6.vite.dev/guide/migration.html" target="_blank" rel="noreferrer">从 v5 迁移指南</a>（<a href="/guide/migration-from-v5.html">中文版</a>），了解如何将你的应用迁移到 Vite 6 所需的变更，然后再继续执行本页中的相关更改。</p>',18)])])}const f=r(l,[["render",t]]);export{u as __pageData,f as default};
